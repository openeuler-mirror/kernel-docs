# 安全编程规范
 
针对 Linux Kernel 内核代码，本文收录了 91 个需要重点关注的API，可为制定编程规范提供依据，也可为代码审计以及相关培训提供指导意见。  

每个 API 对应一条规范，每条规范可直接作为规范条款或审计检查点，读者可根据自身需求从中选取某个子集作为规范或审计依据，从而提高 Linux Kernel 的安全性。  

## 编程规范说明
每条规范包括：  
* 编号：规范在本文中的章节编号  
* 名称： API 名称     
* 描述： API 的描述，API 编程规范，违反编程规范的后果，示例，Git 合并地址等 

规范的描述包含：  
* 示例：规范相关的示例代码
* Git 合并地址：合并到内核的 Commit ID  
* CVE：错误 API 编程范造成的安全漏洞（非必须）  

## 规则列表    
[R001&emsp;vzalloc](#vzalloc)  
[R002&emsp;kzalloc](#kzalloc)  
[R003&emsp;kmalloc](#kmalloc)  
[R004&emsp;kmalloc_array](#kmalloc_array)  
[R005&emsp;kvmalloc_array](#kvmalloc_array)  
[R006&emsp;kmemdup](#kmemdup)  
[R007&emsp;kcalloc](#kcalloc)  
[R008&emsp;devm_kzalloc](#devm_kzalloc)  
[R009&emsp;platform_get_irq](#platform_get_irq)  
[R010&emsp;platform_get_resource](#platform_get_resource)  
[R011&emsp;ioremap](#ioremap)  
[R012&emsp;dma_set_coherent_mask](#dma_set_coherent_mask)  
[R013&emsp;devm_ioremap](#devm_ioremap)  
[R014&emsp;dma_set_mask_and_coherent](#dma_set_mask_and_coherent)  
[R015&emsp;dma_set_max_seg_size](#dma_set_max_seg_size)  
[R016&emsp;pci_enable_device](#pci_enable_device)  
[R017&emsp;devm_request_threaded_irq](#devm_request_threaded_irq)  
[R018&emsp;clk_enable](#clk_enable)  
[R019&emsp;setup_interrupts](#setup_interrupts)  
[R020&emsp;nla_memdup](#nla_memdup)  
[R021&emsp;dma_set_mask](#dma_set_mask)   
[R022&emsp;devm_kcalloc](#devm_kcalloc)  
[R023&emsp;mc13xxx_irq_request](#mc13xxx_irq_request)  
[R024&emsp;wm8350_register_irq](#wm8350_register_irq)  
[R025&emsp;dma_map_single](#dma_map_single)  
[R026&emsp;platform_driver_register](#platform_driver_register)  
[R027&emsp;i2c_add_driver](#i2c_add_driver)  
[R028&emsp;dma_alloc_coherent](#dma_alloc_coherent)  
[R029&emsp;ida_simple_get](#ida_simple_get)  
[R030&emsp;rsnd_mod_power_on](#rsnd_mod_power_on)  
[R031&emsp;coda_iram_alloc](#coda_iram_alloc)  
[R032&emsp;alloc_ordered_workqueue](#alloc_ordered_workqueue)   
[R033&emsp;devm_clk_get](#devm_clk_get)  
[R034&emsp;devm_regulator_get](#devm_regulator_get)  
[R035&emsp;alloc_workqueue](#alloc_workqueue)  
[R036&emsp;create_singlethread_workqueue](#create_singlethread_workqueue)  
[R037&emsp;alloc_percpu](#alloc_percpu)  
[R038&emsp;create_workqueue](#create_workqueue)  
[R039&emsp;kstrdup](#kstrdup)  
[R040&emsp;skb_copy](#skb_copy)  
[R041&emsp;devm_kstrdup](#devm_kstrdup)  
[R042&emsp;mtk_alloc_clk_data](#mtk_alloc_clk_data)  
[R043&emsp;devm_ioport_map](#devm_ioport_map)  
[R044&emsp;devm_regmap_init_mmio](#devm_regmap_init_mmio)  
[R045&emsp;usbnet_get_endpoints](#usbnet_get_endpoints)  
[R046&emsp;idr_alloc](#idr_alloc)  
[R047&emsp;ida_alloc](#ida_alloc)  
[R048&emsp;rtw_alloc_hwxmits](#rtw_alloc_hwxmits)  
[R049&emsp;mipi_dsi_driver_register](#mipi_dsi_driver_register)  
[R050&emsp;nla_put_u32](#nla_put_u32)  
[R051&emsp;crypto_aead_setkey](#crypto_aead_setkey)  
[R052&emsp;alloc_page](#alloc_page)  
[R053&emsp;device_property_read_u32_array](#device_property_read_u32_array)  
[R054&emsp;of_get_child_by_name](#of_get_child_by_name)  
[R055&emsp;module_get_next_page](#module_get_next_page)  
[R056&emsp;regulator_get](#regulator_get)  
[R057&emsp;hashmap__new](#hashmap__new)  
[R058&emsp;get_sg_table](#get_sg_table)  
[R059&emsp;alloc_memory_type](#alloc_memory_type)  
[R060&emsp;mlx5_get_uars_page](#mlx5_get_uars_page)  
[R061&emsp;kstrndup](#kstrndup)  
[R062&emsp;kstrdup_const](#kstrdup_const)  
[R063&emsp;nfc_llcp_build_tlv](#nfc_llcp_build_tlv)  
[R064&emsp;alloc_netdev](#alloc_netdev)  
[R065&emsp;netdev_alloc_skb](#netdev_alloc_skb)  
[R066&emsp;platform_device_alloc](#platform_device_alloc)  
[R067&emsp;kvzalloc](#kvzalloc)  
[R068&emsp;kvmalloc](#kvmalloc)  
[R069&emsp;nlmsg_new](#nlmsg_new)  
[R070&emsp;usb_alloc_urb](#usb_alloc_urb)  
[R071&emsp;dev_alloc_skb](#dev_alloc_skb)  
[R072&emsp;ieee80211_alloc_hw](#ieee80211_alloc_hw)  
[R073&emsp;spi_alloc_slave](#spi_alloc_slave)  
[R074&emsp;spi_alloc_master](#spi_alloc_master)  
[R075&emsp;alloc_skb](#alloc_skb)  
[R076&emsp;ib_umem_get](#ib_umem_get)  
[R077&emsp;nfp_repr_alloc](#nfp_repr_alloc)  
[R078&emsp;snd_card_new](#snd_card_new)  
[R079&emsp;vmalloc](#vmalloc)  
[R080&emsp;fsnotify_find_mark](#fsnotify_find_mark)    
[R081&emsp;alloc_smp_req](#alloc_smp_req)  
[R082&emsp;ring_buffer_alloc](#ring_buffer_alloc)  
[R083&emsp;of_find_device_by_node](#of_find_device_by_node)  
[R084&emsp;drm_gem_shmem_get_sg_table](#drm_gem_shmem_get_sg_table)  
[R085&emsp;dwc3_qcom_create_urs_usb_platdev](#dwc3_qcom_create_urs_usb_platdev)  
[R086&emsp;devm_gpiod_get_optional](#devm_gpiod_get_optional)  
[R087&emsp;xa_alloc_cyclic](#xa_alloc_cyclic)  
[R088&emsp;memdup_user](#memdup_user)  
[R089&emsp;virtqueue_get_buf](#virtqueue_get_buf)  
[R090&emsp;crypto_alloc_aead](#crypto_alloc_aead)  
[R091&emsp;match_strdup](#match_strdup)


### <span id = "vzalloc">R001&emsp;vzalloc</span>  
<hr/>  

**描述**  
vzalloc() 分配虚拟连续内存并用 0 填充。不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 vzalloc() 返回值是否为空；  
规范点2：该 API 使用后释放申请的内存。

**示例**  
```c
a = vzalloc(...)
if(!a)  //编程规范点1：检查 vzalloc() 返回值
   ...
...
vfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
e6a21a14106d9718aa4f8e115b1e474888eeba44  

**CVE**  
CVE-2022-3078 
</br>
</br>
### <span id = "kzalloc">R002&emsp;kzalloc</span>   
<hr/>  

**描述**  
kzalloc() 分配连续物理内存，并将所分配内存空间设置为 0。不当使用会造成内存泄漏、空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 kzalloc() 返回值是否为空；  
规范点2：该 API 使用后释放申请的内存。

**示例**
```c
a = kzalloc(...)
if(!a)  //编程规范点1：检查 kzalloc() 返回值
   ...
...
kfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
385aee965b4e4c36551c362a334378d2985b722a  
a0ecd6fdbf5d648123a7315c695fb6850d702835  
45c1380358b12bf2d1db20a5874e9544f56b34ab  
c0a333d842ef67ac04adc72ff79dc1ccc3dca4ed  
fea3fdf975dd9f3e5248afaab8fe023db313f005  
4aa7afb0ee20a97fbf0c5bab3df028d5fb85fdab  
6f3ef5c25cc762687a7341c18cbea5af54461407  
bbe692e349e2a1edf3fe0a29a0e05899c9c94d51  
a7b2df76b42bdd026e3106cf2ba97db41345a177  
34b3be18a04ecdc610aae4c48e5d1b799d8689f6  
0e62395da2bd5166d7c9e14cbc7503b256a34cb0  
fc739a058d99c9297ef6bfd923b809d85855b9a9  
a21b7f0cff1906a93a0130b74713b15a0b36481d  
8572cea1461a006bce1d06c0c4b0575869125fa4  
8ce39eb5a67aee25d9f05b40b673c95b23502e3e  
104c307147ad379617472dd91a5bcb368d72bd6d  
055e547478a11a6360c7ce05e2afc3e366968a12  
003b686ace820ce2d635a83f10f2d7f9c147dabc  
27d461333459d282ffa4a2bdb6b215a59d493a8f  
73c3ed7495c67b8fbdc31cf58e6ca8757df31a33  
40543b3d9d2c13227ecd3aa90a713c201d1d7f09  
b0576ade3aaf24b376ea1a4406ae138e2a22b0c0  
93340e10b9c5fc86730d149636e0aa8b47bb5a34  
13fcfcb2a9a4787fe4e49841d728f6f2e9fa6911  
c96988b7d99327bb08bd9efd29a203b22cd88ace  
d6f5e358452479fa8a773b5c6ccc9e4ec5a20880  
c8c80c996182239ff9b05eda4db50184cf3b2e99  
aa7253c2393f6dcd6a1468b0792f6da76edad917  

**CVE**  
CVE-2017-10810  
CVE-2019-18810  
CVE-2019-18811  
CVE-2019-18812  
CVE-2019-19043  
CVE-2019-19046  
CVE-2019-19051  
CVE-2019-19053  
CVE-2019-19054  
CVE-2019-19065  
CVE-2019-19066  
CVE-2019-19069  
CVE-2019-19079  
CVE-2019-19080  
CVE-2019-19081  
CVE-2019-19082  
CVE-2019-19083  
CVE-2019-20095  
CVE-2022-30853  
CVE-2022-3115  
CVE-2023-3359  
CVE-2023-3220  
CVE-2022-0168  
CVE-2022-3112  
CVE-2022-47941 
</br>
</br>
### <span id = "kmalloc">R003&emsp;kmalloc</span>   
<hr/>  

**描述**  
kmalloc() 分配连续物理内存空间，内存地址上的内容随机。不当使用会造成内存泄漏、空指针解引用等漏洞。  
  
**编程规范**  
规范点1：检查 kmalloc() 返回值是否为空；  
规范点2：该 API 使用后释放申请的内存。

**示例**
```c
a = kmalloc(...)
if(!a)  //编程规范点1：检查 kmalloc() 返回值
   ...
...
kfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
128c66429247add5128c03dc1e144ca56f05a4e2  
2289adbfa559050d2a38bcd9caac1c18b800e928  
6402939ec86eaf226c8b8ae00ed983936b164908  
425aa0e1d01513437668fa3d4a971168bbaa8515  
407ecd1bd726f240123f704620d46e285ff30dd9  
4a9800c81d2f34afb66b4b42e0330ae8298019a2  
6e5e5defdb8b0186312c2f855ace175aee6daf9b  
f30ce3d3760b22ee33c8d9c2e223764ad30bdc5f  
d839f0811a31322c087a859c2b181e2383daa7be

**CVE**  
CVE-2019-18808  
CVE-2019-18809  
CVE-2019-19075  
CVE-2019-12381  
CVE-2022-3106  
CVE-2022-3104  
CVE-2023-3355
</br>
</br>
### <span id = "kmalloc_array">R004&emsp;kmalloc_array</span>    
<hr/>  

**描述**  
kmalloc_array() 为数组分配内存。不当使用会造成空指针解引用等漏洞。   

**编程规范**  
规范点1：检查 kmalloc_array() 返回值是否为空；  
规范点2：该 API 使用后释放申请的内存。

**示例**
```c
a = kmalloc_array(...)
if(!a)  //编程规范点1：检查 kmalloc_array() 返回值
   ...
...
kfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
4e78921ba4dd0aca1cc89168f45039add4183f8e  
96c5c6e6a5b6db592acae039fed54b5c8844cd35  
7694a7de22c53a312ea98960fcafc6ec62046531    

**CVE**  
CVE-2019-12380  
CVE-2019-19072  
CVE-2022-3105
</br>
</br>
### <span id = "kvmalloc_array">R005&emsp;kvmalloc_array</span>   
<hr/>  

**描述**  
kvmalloc_array() 根据分配内存大小调用 kmalloc() 或 vmalloc() 分配物理内存。一次性分配多个并返回数组。不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 kvmalloc_array() 返回值是否为空；  
规范点2：该 API 使用后释放申请的内存。

**示例**
```c
a = kvmalloc_array(...)
if(!a)  //编程规范点1：检查 kvmalloc_array() 返回值
   ...
...
kvfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
886e44c9298a6b428ae046e2fa092ca52e822e6a  

**CVE**  
CVE-2022-3107 
</br>
</br>
### <span id = "kmemdup">R006&emsp;kmemdup</span>    
<hr/>  

**描述**  
kmemdup() 根据给定的一段地址空间,再分配一个内存空间,并将原地址空间中的内容拷贝到新分配的内存空间中。不当使用会造成内存泄漏、空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 kmemdup() 返回值是否为空；  
规范点2：该 API 使用后释放申请的内存。

**示例**
```c
a = kmemdup(...)
if(!a)  //编程规范点1：检查 kmemdup() 返回值
   ...
...
kfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
e13de8fe0d6a51341671bbe384826d527afe8d44  
1d3ff0950e2b40dc861b1739029649d03f591820  
abfaf0eee97925905e742aa3b0b72e04a918fa9e  
8027a9ad9b3568c5eb49c968ad6c97f279d76730  
38b16d6cfe54c820848bcfc999bc5e8a7da1cefb  
a72c01a94f1d285a274219d36e2a17b4846c0615  
9e6fd874c7bb47b6a4295abc4c81b2f41b97e970  
e6c3cef24cb0d045f99d5cb039b344874e3cfd74  

**CVE**  
CVE-2019-19049  
CVE-2019-20096  
CVE-2022-3108 
</br>
</br>  
### <span id = "kcalloc">R007&emsp;kcalloc</span>    
<hr/>  

**描述**  
kcalloc() 对数组分配连续物理内存，并将所分配内存空间设置为 0。不当使用会造成内存泄漏、空指针解引用等漏洞。   

**编程规范**  
规范点1：检查 kcalloc() 返回值是否为空；  
规范点2：该 API 使用后释放申请的内存。

**示例**
```c
a = kcalloc(...)  
if(!a)  //编程规范点1：检查 kcalloc() 返回值
   ...
   
...
kfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
68501df92d116b760777a2cfda314789f926476f  
29cd13cfd7624726d9e6becbae9aa419ef35af7f  
b4b814fec1a5a849383f7b3886b654a13abbda7d  
ab612b1daf415b62c58e130cb3d0f30b255a14d0  
9c0530e898f384c5d279bfcebd8bb17af1105873  
3f93616951138a598d930dcaec40f2bfd9ce43bb  
57be09c6e8747bf48704136d9e3f92bfb93f5725  
ed713e2bc093239ccd380c2ce8ae9e4162f5c037  
60ec7fcfe76892a1479afab51ff17a4281923156  
bdf1b5c3884f6a0dc91b0dbdb8c3b7d205f449e0  
9b8bdd1eb5890aeeab7391dddcf8bd51f7b07216  
5f9562ebe710c307adc5f666bf1a2162ee7977c0  
b3d40c3ec3dc4ad78017de6c3a38979f57aaaab8  
c35ca10f53c51eeb610d3f8fbc6dd6d511b58a58  
fa0ef93868a6062babe1144df2807a8b1d4924d2  

**CVE**  
CVE-2019-18807  
CVE-2019-19044  
CVE-2019-19058  
CVE-2019-19060  
CVE-2019-19061  
CVE-2019-19063  
CVE-2019-19067  
CVE-2021-45480  
CVE-2022-3114  
CVE-2023-3358  
CVE-2023-22995
</br>
</br>  
### <span id = "devm_kzalloc">R008&emsp;devm_kzalloc</span>     
<hr/>  

**描述**  
devm_kzalloc() 与设备绑定，申请内存并将其初始化为 0。不当使用会造成空指针解引用等漏洞。   

**编程规范**  
规范点：检查 devm_kzalloc() 返回值是否为空。

**示例**
```c
a = devm_kzalloc(...)
if(!a)  //编程规范点：检查 devm_kzalloc() 返回值
   ...
```

**Git 合并地址**  
e25a89f743b18c029bfbe5e1663ae0c7190912b0  
13251ce1dd9bb525da2becb9b26fdfb94ca58659  

**CVE**  
CVE-2022-3113 
</br>
</br>  
### <span id = "platform_get_irq">R009&emsp;platform_get_irq</span>    
<hr/>  

**描述**  
platform_get_irq() 获取平台设备的 IRQ，如果查找 IRQ 失败，则打印错误消息。不当使用会造成未捕获异常等问题。   

**编程规范**  
规范点：检查 platform_get_irq() 返回值是否为小于 0。

**示例**
```c
a = platform_get_irq(...)
if(a < 0)  //编程规范点：检查 platform_get_irq() 返回值
   ...
```

**Git 合并地址**  
3e68f331c8c759c0daa31cc92c3449b23119a215  
b38cd3b42fba66cc538edb9cf77e07881f43f8e2  
db6d6afe382de5a65d6ccf51253ab48b8e8336c3  
cb93b3e11d405f20a405a07482d01147ef4934a3  
99d7fbb5cedf598f67e8be106d6c7b8d91366aef  
c6564c13dae25cd7f8e1de5127b4da4500ee5844   
c1bcb976d8feb107ff2c12caaf12ac5e70f44d5f
</br>
</br>  
### <span id = "platform_get_resource">R010&emsp;platform_get_resource</span>  
<hr/>  

**描述**  
platform_get_resource() 获取设备的资源。不当使用会造成未捕获异常等问题。   

**编程规范**  
规范点：检查 platform_get_resource() 返回值是否为空。

**示例**
```c
a = platform_get_resource(...)
if(!a)  //编程规范点：检查 platform_get_resource() 返回值
   ...
```

**Git 合并地址**  
1c1348bf056dee665760a3bd1cd30b0be7554fc2  
4d315357b3d6c315a7260420c6c6fc076e58d14b  
9d54c5d47406588f7bae9b72bd9f922b33434327  
d918e0d5824495a75d00b879118b098fcab36fdb  
297a6961ffb8ff4dc66c9fbf53b924bd1dda05d5  
9903e41ae1f5d50c93f268ca3304d4d7c64b9311  

**CVE**  
CVE-2018-8043  
CVE-2018-10074 
</br>
</br> 
### <span id = "ioremap">R011&emsp;ioremap</span>   
<hr/>  

**描述**  
ioremap() 将一个 IO 地址空间映射到内核的虚拟地址空间。不当使用会造成空指针解引用、未捕获异常等漏洞。  

**编程规范**  
规范点：检查 ioremap() 返回值是否为空。

**示例**
```c
a = ioremap(...)
if(!a)  //编程规范点：检查 ioremap() 返回值
   ...
```

**Git 合并地址**  
a222fd8541394b36b13c89d1698d9530afd59a9c  
2576e153cd982d540b212e989458edc42ad1b390  
3ecb46755eb85456b459a1a9f952c52986bce8ec  
7e4760713391ee46dc913194b33ae234389a174e  
9a36e2d44d122fe73a2a76ba73f1d50a65cf8210  
16e0077e14a73866e9b0f4a6bf4ad3d4a5cb0f2a  
ad64639417161e90b30dda00486570eb150aeee5  
4556c36f4a23fb218763cdb7a20f6a94f4faf1f8
</br>
</br>  
### <span id = "dma_set_coherent_mask">R012&emsp;dma_set_coherent_mask</span>     
<hr/>  

**描述**  
dma_set_coherent_mask() 执行一致性内存映射分配。不当使用会造未捕获异常等问题。   

**编程规范**  
规范点：检查 dma_set_coherent_mask() 返回值是否为 0。

**示例**
```c
a = dma_set_coherent_mask(...)
if(a)  //编程规范点：检查 dma_set_coherent_mask() 返回值
   ...
```

**Git 合并地址**  
eec91694f927d1026974444eb6a3adccd4f1cbc2  
128f6ec95a282b2d8bc1041e59bf65810703fa44  
43f0633f89947df57fe0b5025bdd741768007708 
</br>
</br>  
### <span id = "devm_ioremap">R013&emsp;devm_ioremap</span>    
<hr/>  

**描述**  
devm_ioremap() 获取 IO 所有权和映射功能。不当使用会造成空指针解引用等漏洞。   

**编程规范**  
规范点：检查 devm_ioremap() 返回值是否为空。

**示例**
```c
a = devm_ioremap(...)
if(!a)  //编程规范点：检查 devm_ioremap() 返回值
   ...
```

**Git 合并地址**  
d5a73ec96cc57cf67e51b12820fc2354e7ca46f8  
2cea3ec5b0099d0e9dd6752aa86e08bce38d6b32
</br>
</br>  
### <span id = "dma_set_mask_and_coherent">R014&emsp;dma_set_mask_and_coherent</span>    
<hr/>  

**描述**  
dma_set_mask_and_coherent() 用于对 dma_mask 和 coherent_dma_mask 赋值。不当使用会造成未捕获的异常等问题。   

**编程规范**  
规范点：检查 dma_set_mask_and_coherent() 返回值是否为 0。

**示例**
```c
a = dma_set_mask_and_coherent(...)
if(a)  //编程规范点：检查 dma_set_mask_and_coherent() 返回值
   ...
```

**Git 合并地址**  
1b1f98dd70dcfd25476adabcbe72484312e879f7  
40c67c291a93f8846c4a972c9ef1b7ba4544c8d0  
2d21543efe332cd8c8f212fb7d365bc8b0690bfa  
1fdbbfd5099f797a4dac05e7ef0192ba4a9c39b4  
44ab30b056149bd59dd7989a593dd25ead6007fd  
4a39156166b90465da0f9a33b3442d63b5651bec 
</br>
</br>  
### <span id = "dma_set_max_seg_size">R015&emsp;dma_set_max_seg_size</span>   
<hr/>  

**描述**  
dma_set_max_seg_size() 用来设置设备 DMA 传输单次传输能够处理的最大数据长度。不当使用会造成未捕获的异常等问题。   

**编程规范**  
规范点：检查 dma_set_max_seg_size() 返回值是否为 0。

**示例**
```c
a = dma_set_max_seg_size(...)
if(a)  //编程规范点：检查 dma_set_max_seg_size() 返回值
   ...
```

**Git 合并地址**  
da2ad87fba0891576aadda9161b8505fde81a84d 
</br>
</br>  
### <span id = "pci_enable_device">R016&emsp;pci_enable_device</span>   
<hr/>  

**描述**  
pci_enable_device() 在驱动程序使用设备之前对其进行初始化。不当使用会造成未捕获的异常等问题。   

**编程规范**  
规范点：检查 pci_enable_device() 返回值是否小于 0。

**示例**
```c
a = pci_enable_device(...)
if(a < 0)  //编程规范点：检查 pci_enable_device() 返回值
   ...
```

**Git 合并地址**  
9c27896ac1bb83ea5c461ce6f7089d02102a2b21 
</br>
</br>  
### <span id = "devm_request_threaded_irq">R017&emsp;devm_request_threaded_irq</span>    
<hr/>  

**描述**  
devm_request_threaded_irq() 请求并注册一个线程化的中断处理程序。不当使用会造成空指针解引用等漏洞。   

**编程规范**  
规范点：检查 devm_request_threaded_irq() 返回值是否为 0。

**示例**
```c
a = devm_request_threaded_irq(...)
if(a)  //编程规范点：检查 devm_request_threaded_irq() 返回值
   ...
```

**Git 合并地址**  
b30537a4cedcacf0ade2f33ebb7610178ed1e7d7 
</br>
</br>  
### <span id = "clk_enable">R018&emsp;clk_enable</span>    
<hr/>  

**描述**  
clk_enable() 通知系统时钟源应该何时运行。不当使用会造成未捕获的异常等问题。  

**编程规范**  
规范点：检查 clk_enable() 返回值是否为 0。

**示例**
```c
a = clk_enable(...)
if(a)  //编程规范点：检查 clk_enable() 返回值
   ...
```

**Git 合并地址**  
ca1697eb09208f0168d94b88b72f57505339cbe5  
ed7c9fef11931fc5d32a83d68017ff390bf5c280  
2ecf362d220317debf5da376e0390e9f7a3f7b29  
45ea97d74313bae681328b0c36fa348036777644  
f9e2ca0640e59d19af0ff285ee5591ed39069b09  
405afed8a728f23cfaa02f75bbc8bdd6b7322123  
6babfc6e6fab068018c36e8f6605184b8c0b349d  
2169b79258c8be803d2595d6456b1e77129fe154  
09e7af76db02c74f2a339b3cb2d95460fa2ddbe4 
</br>
</br>  
### <span id = "setup_interrupts">R019&emsp;setup_interrupts</span>    
<hr/>  

**描述**  
setup_interrupts() 设置中断。不当使用会造成未捕获的异常等问题。   

**编程规范**  
规范点：检查 setup_interrupts() 返回值是否为 0。

**示例**
```c
a = setup_interrupts(...)
if(a)  //编程规范点：检查 setup_interrupts() 返回值
   ...
```

**Git 合并地址**  
fd7bd80b46373887b390852f490f21b07e209498 
</br>
</br>  
### <span id = "nla_memdup">R020&emsp;nla_memdup</span>   
<hr/>  

**描述**  
nla_memdup() 同 kmemdup()，根据给定的一段地址空间再分配一个内存空间，并将原地址空间中的内容拷贝到新分配的内存空间中。   

**编程规范**  
规范点1：检查 nla_memdup() 返回值是否为空；  
规范点2：该 API 使用后释放申请的内存。

**示例**
```c
a = nla_memdup(...)
if(!a)  //编程规范点1：检查 nla_memdup() 返回值
   ...
...
kfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
6ad27f522cb3b210476daf63ce6ddb6568c0508b 
</br>
</br>  
### <span id = "dma_set_mask">R021&emsp;dma_set_mask</span>     
<hr/>  

**描述**  
dma_set_mask() 查询设备 DMA 寻址范围。不当使用会造成未捕获的异常等问题。  

**编程规范**  
规范点：检查 dma_set_mask() 返回值是否为 0。

**示例**
```c
a = dma_set_mask(...)
if(a)  //编程规范点：检查 dma_set_mask 返回值
   ...
```

**Git 合并地址**  
13262fc26c1837c51a5131dbbdd67a2387f8bfc7  
947c70a213769f60e9d5aca2bc88b50a1cfaf5a6  
1832fba7f9780aff67c96ad30f397c2d76141833
</br>
</br>  
### <span id = "devm_kcalloc">R022&emsp;devm_kcalloc</span>    
<hr/>  

**描述**  
devm_kcalloc() 在设备驱动程序中动态分配内存空间，并将内存与设备资源捆绑在一起，同时对内存进行清零处理。不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点：检查 devm_kcalloc() 返回值是否为空。

**示例**
```c
a = devm_kcalloc(...)
if(!a)  //编程规范点：检查 devm_kcalloc 返回值
   ...
```

**Git 合并地址**  
2e81948177d769106754085c3e03534e6cc1f623  
5a811126d38f9767a20cc271b34db7c8efc5a46c  
cd07eadd5147ffdae11b6fd28b77a3872f2a2484  
60591bbf6d5eb44f275eb733943b7757325c1b60  
2790143f09938776a3b4f69685b380bae8fd06c7  
b0eeba527e704d6023a6cd9103f929226e326b03 
</br>
</br>  
### <span id = "mc13xxx_irq_request">R023&emsp;mc13xxx_irq_request</span>  
<hr/>  

**描述**  
mc13xxx_irq_request() 申请中断。不当使用会造成未捕获的异常等问题。 

**编程规范**  
规范点：检查 mc13xxx_irq_request() 返回值是否为 0。

**示例**
```c
a = mc13xxx_irq_request(...)
if(a)  //编程规范点：检查 mc13xxx_irq_request() 返回值
   ...
```

**Git 合并地址**  
e477e51a41cb5d6034f3c5ea85a71ad4613996b9 
</br>
</br>  
### <span id = "wm8350_register_irq">R024&emsp;wm8350_register_irq</span>  
<hr/>  

**描述**  
wm8350_register_irq() 为 WM8350 申请内部中断。不当使用会造成内存泄漏、未捕获的异常等问题。  

**编程规范**  
规范点1：检查 wm8350_register_irq() 返回值是否为零；  
规范点2：该 API 使用后，调用 wm8350_free_irq() 函数释放相应的中断。

**示例**
```c
a = wm8350_register_irq(...)
if(a)  //编程规范点1：检查 wm8350_register_irq() 返回值
   ...
...
wm8350_free_irq(...)  //编程规范点2：使用后释放
```

**Git 合并地址**  
6dee930f6f6776d1e5a7edf542c6863b47d9f078  
db0350da8084ad549bca16cc0486c11cc70a1f9b  
43f0269b6b89c1eec4ef83c48035608f4dcdd886  
b0b14b5ba11bec56fad344a4a0b2e16449cc8b94  

**CVE**  
CVE-2022-3111
</br>
</br>  
### <span id = "dma_map_single">R025&emsp;dma_map_single</span>    
<hr/>
  
**描述**  
dma_map_single() 将一块连续物理内存建立 DMA 地址进行映射。不当使用会造成空指针解引用、未捕获的异常等漏洞。  

**编程规范**  
规范点：使用 dma_mapping_error() 检测其返回值是否为 0。

**示例**
```c
a = dma_map_single(...)
if(dma_mapping_error(XXX, a))  //编程规范点：检查 dma_mapping_error() 返回值
   ...
```

**Git 合并地址**  
0f74b29a4f53627376cf5a5fb7b0b3fa748a0b2b  
32fe45274edb5926abc0fac7263d9f889d02d9cf 
</br>
</br>    
### <span id = "platform_driver_register">R026&emsp;platform_driver_register</span>    
<hr/>  

**描述**  
platform_driver_register() 用于向系统注册一个平台驱动程序。不当使用会造成未捕获的异常等问题。  

**编程规范**  
规范点：检查 platform_driver_register() 返回值是否为 0。

**示例**
```c
a = platform_driver_register(...)
if(a)  //编程规范点：检查 platform_driver_register() 返回值
   ...
```

**Git 合并地址**  
ab2d2a982ff721f4b029282d9a40602ea46a745e  
6ba12b56b9b844b83ed54fb7ed59fb0eb41e4045  
011881b80ebe773914b59905bce0f5e0ef93e7ba  
97d5ec548150764946f38632e62e79759832b54b  
8325a6c24ad78b8c1acc3c42b098ee24105d68e5 
</br>
</br>  
### <span id = "i2c_add_driver">R027&emsp;i2c_add_driver</span>     
<hr/>  

**描述**  
i2c_add_driver() 用于向内核注册 i2c 驱动。不当使用会造成未捕获的异常等问题。  

**编程规范**  
规范点：检查 i2c_add_driver() 返回值是否为 0。

**示例**
```c
a = i2c_add_driver(...)
if(a)  //编程规范点：检查 i2c_add_driver() 返回值
   ...
```

**Git 合并地址**  
82fa8f581a954ddeec1602bed9f8b4a09d100e6e 
</br>
</br>  
### <span id = "dma_alloc_coherent">R028&emsp;dma_alloc_coherent</span>  
<hr/>  

**描述**  
dma_alloc_coherent() 用于在设备可访问的内存中分配一块连续的内存空间，并且这块内存空间在物理上也是连续的。不当使用会造成内存泄漏、空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 dma_alloc_coherent() 返回值是否为空；  
规范点2：该 API 使用后，dma_free_coherent() 函数释放申请的内容。

**示例**
```c
a = dma_alloc_coherent(...)
if(!a)  //编程规范点1：检查 dma_alloc_coherent() 返回值
   ...
...
dma_free_coherent(...)  //编程规范点2：使用后释放
```

**Git 合并地址**  
0f4f199443faca715523b0659aa536251d8b978f  
aa7069d840dab6bef4887657b94e439c82ae985a  
82f76a4a720791d889de775b5f7541d601efc8bd  
53ffa6a9f83b2170c60591da1ead8791d5a42e81  

**CVE**  
CVE-2019-19059  
CVE-2023-3357 
</br>
</br>  
### <span id = "ida_simple_get">R029&emsp;ida_simple_get</span>     
<hr/>  

**描述**  
ida_simple_get() 已弃用，使用 ida_alloc() 代替。不当使用会造成未捕获的异常等问题。  

**编程规范**  
规范点：检查 ida_simple_get() 返回值是否小于 0。

**示例**
```c
a = ida_simple_get(...)
if(a < 0)  //编程规范点：检查 ida_simple_get() 返回值
   ...
```

**Git 合并地址**  
35af9fb49bc5c6d61ef70b501c3a56fe161cce3e
</br>
</br>
### <span id = "rsnd_mod_power_on">R030&emsp;rsnd_mod_power_on</span>    
<hr/>  

**描述**  
rsnd_mod_power_on() 通知系统时钟源应该何时运行。不当使用会造成未捕获的异常等问题。  

**编程规范**  
规范点：检查 rsnd_mod_power_on() 返回值是否小于 0。

**示例**
```c
a = rsnd_mod_power_on(...)
if(a < 0)  //编程规范点：检查 rsnd_mod_power_on() 返回值
   ...
```

**Git 合并地址合并地址**  
376be51caf8871419bbcbb755e1e615d30dc3153 
</br>
</br>  
### <span id = "coda_iram_alloc">R031&emsp;coda_iram_alloc</span>    
<hr/>  

**描述**  
coda_iram_alloc() 分配工作缓冲区。不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点：检查 coda_iram_alloc() 返回值是否为 0。

**示例**
```c
a = coda_iram_alloc(...)
if(!a)  //编程规范点：检查 coda_iram_alloc() 返回值
   ...
```

**Git 合并地址**  
6b8082238fb8bb20f67e46388123e67a5bbc558d 
</br>
</br>  
### <span id = "alloc_ordered_workqueue">R032&emsp;alloc_ordered_workqueue</span>     
<hr/>  

**描述**  
alloc_ordered_workqueue() 分配有序的工作队列。不当使用会造成内存泄漏、空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 alloc_ordered_workqueue() 返回值是否为空；  
规范点2：该 API 使用后，调用 destroy_workqueue() 函数终止工作队列。

**示例**
```c
a = alloc_ordered_workqueue(...)
if(!a)  //编程规范点1：检查 alloc_ordered_workqueue() 返回值
   ...
...
destroy_workqueue(a)  //编程规范点2：使用后终止工作队列
```

**Git 合并地址**  
4f431a047a5c8698ed4b67e2760cfbeb5fffb69d  
115906ca7b535afb1fe7b5406c566ccd3873f82b  
643b7d0869cc7f1f7a5ac7ca6bd25d88f54e31d0  
afe4cb96153a0d8003e4e4ebd91b5c543e10df84 
</br>
</br>   
### <span id = "devm_clk_get">R033&emsp;devm_clk_get</span>    
<hr/>  

**描述**  
devm_clk_get() 查找并获得对时钟生成器的托管引用。不当使用会造成未捕获的异常、空指针解引用等漏洞。  

**编程规范**  
规范点：使用 IS_ERR() 检查 devm_clk_get() 返回值。

**示例**
```c
a = devm_clk_get(...)
if(IS_ERR(a))  //编程规范点：检查 devm_clk_get() 返回值
   ...
```

**Git 合并地址**  
9de2b9286a6dd16966959b3cb34fc2ddfd39213e  
68b4f9e0bdd0f920d7303d07bfe226cd0976961d 
</br>
</br>  
### <span id = "devm_regulator_get">R034&emsp;devm_regulator_get</span>  
<hr/>  

**描述**  
devm_regulator_get() 为资源管理的 regulator_get()。不当使用会造成未捕获的异常等问题。  

**编程规范**  
规范点：使用 IS_ERR() 检查 devm_regulator_get() 返回值。

**示例**
```c
a = devm_regulator_get(...)
if(IS_ERR(a))  //编程规范点：检查 devm_regulator_get() 返回值
   ...
```

**Git 合并地址**  
da8e05f84a11c3cc3b0ba0a3c62d20e358002d99 
</br>
</br>  
### <span id = "alloc_workqueue">R035&emsp;alloc_workqueue</span>   
<hr/>  

**描述**  
alloc_workqueue() 用于分配一个工作队列。不当使用会造成内存泄漏等漏洞。   

**编程规范**  
规范点1：检查 alloc_workqueue() 返回值是否为空；  
规范点2：该 API 使用后，调用 destroy_workqueue() 函数终止工作队列。

**示例**
```c
a = alloc_workqueue(...)
if(!a)  //编程规范点1：检查 alloc_workqueue()返回值
   ...
...
destroy_workqueue(a)  //编程规范点2：使用后终止工作队列
```

**Git 合并地址**  
01ca667133d019edc9f0a1f70a272447c84ec41f  
ed9e6166eb0984b718facb7ca59296098cc3aa64  

**CVE**  
CVE-2019-15924
</br>
</br>  
### <span id = "create_singlethread_workqueue">R036&emsp;create_singlethread_workqueue</span>    
<hr/>  

**描述**  
create_singlethread_workqueue() 在一个 CPU 上创建一个内核线程。不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 create_singlethread_workqueue() 返回值是否为空；  
规范点2：该 API 使用后，调用 destroy_workqueue() 函数终止工作队列。

**示例**
```c
a = create_singlethread_workqueue(...)
if(!a)  //编程规范点1：检查 create_singlethread_workqueue() 返回值
   ...
...
destroy_workqueue(a)  //编程规范点2：使用后终止工作队列
```

**Git 合并地址**  
26e6775f75517ad6844fe5b79bc5f3fa8c22ee61  
1fdeb8b9f29dfd64805bb49475ac7566a3cb06cb 
</br>
</br>
### <span id = "alloc_percpu">R037&emsp;alloc_percpu</span>   
<hr/>  

**描述**  
alloc_percpu() 为动态 per-cpu 变量分配内存。不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 alloc_percpu() 返回值是否为空；  
规范点2：该 API 使用后，调用 free_percpu() 函数释放内存。

**示例**
```c
a = alloc_percpu(...)
if(!a)  //编程规范点1：检查 alloc_percpu() 返回值
   ...
...
free_percpu(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
d3aa3e060c4a80827eb801fc448debc9daa7c46b
</br>
</br>  
### <span id = "create_workqueue">R038&emsp;create_workqueue</span>    
<hr/>  

**描述**  
create_workqueue() 用于创建新的工作队列和相应的线程。不当使用会造成空指针解引用等漏洞。 

**编程规范**  
规范点1：检查 create_workqueue() 返回值是否为空；  
规范点2：该 API 使用后，调用 destroy_workqueue() 函数终止工作队列。

**示例**
```c
a = create_workqueue(...)
if(!a)  //编程规范点1：检查 create_workqueue() 返回值
   ...
...
destroy_workqueue(a)  //编程规范点2：使用后终止工作队列
```

**Git 合并地址**  
2371adeab717d8fe32144a84f3491a03c5838cfb
</br>
</br>  
### <span id = "kstrdup">R039&emsp;kstrdup</span>   
<hr/>  

**描述**  
kstrdup() 为现有字符串分配空间并复制该字符串。不当使用会造成内存泄漏、空指针解引用等漏洞。 

**编程规范**  
规范点1：检查 kstrdup() 返回值是否为空；  
规范点2：该 API 使用后释放申请的内存。

**示例**
```c
a = kstrdup(...)
if(!a)  //编程规范点1：检查 kstrdup() 返回值
   ...
...
kfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
efa9ace68e487ddd29c2b4d6dd23242158f1f607  
d97038d5ec2062733c1e016caf9baaf68cf64ea1  
b5c9ee8296a3760760c7b5d2e305f91412adc795  
c5586d0f711e9744d0cade39b0c4a2d116a333ca  
6fd4ebfc4d61e3097b595ab2725d513e3bbd6739  
a19d48f7c5d57c0f0405a7d4334d1d38fe9d3c1c  
1fd6eb12642e0c32692924ff359c07de4b781d78  
76a2c5df6ca8bd8ada45e953b8c72b746f42918d  

**CVE**  
CVE-2019-12614
</br>
</br>
### <span id = "skb_copy">R040&emsp;skb_copy</span>     
<hr/>  

**描述**  
skb_copy() 创建 sk_buff 的专用副本。不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 skb_copy() 返回值是否为空；  
规范点2：该 API 使用后释放申请的缓冲区。

**示例**
```c
a = skb_copy(...)
if(!a)  //编程规范点1：检查 skb_copy() 返回值
   ...
...
kfree_skb(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
87355b7c3da9bfd81935caba0ab763355147f7b
</br>
</br>  
### <span id = "devm_kstrdup">R041&emsp;devm_kstrdup</span>    
<hr/>  

**描述**  
devm_kstrdup() 分配资源管理的空间，并将现有字符串复制到其中。不当使用会造成未捕获的异常等问题。  

**编程规范**  
规范点：检查 devm_kstrdup() 返回值是否为空。

**示例**
```c
a = devm_kstrdup(...)
if(!a)  //编程规范点：检查 devm_kstrdup() 返回值
   ...
```

**Git 合并地址**  
c04efbfd76d23157e64e6d6147518c187ab4233a 
</br>
</br>  
### <span id = "mtk_alloc_clk_data">R042&emsp;mtk_alloc_clk_data</span>  
<hr/>  

**描述**  
mtk_alloc_clk_data() 分配并初始化时钟数据。不当使用会造成空指针解引用等漏洞。 

**编程规范**  
规范点1：检查 mtk_alloc_clk_data() 返回值是否为零；  
规范点2：该 API 使用后，调用 mtk_free_clk_data() 函数释放申请的缓冲区。

**示例**
```c
a = mtk_alloc_clk_data(...)  //编程规范点1：检查 mtk_alloc_clk_data() 返回值
if(!a)
   ...
...
mtk_free_clk_data(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
0d6e24b422a2166a9297a8286ff2e6ab9a5e8cd3  
2befa515c1bb6cdd33c262b909d93d1973a219aa  
0884393c63cc9a1772f7121a6645ba7bd76feeb9  
606f6366a35a3329545e38129804d65ef26ed7d2  
1f57f78fbacf630430bf954e5a84caafdfea30c0  
b82681042724924ae3ba0f2f2eeec217fa31e830 
</br>
</br>  
### <span id = "devm_ioport_map">R043&emsp;devm_ioport_map</span>     
<hr/>  

**描述**  
devm_ioport_map() 用于映射 I/O 端口地址范围到内核地址空间。不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点：检查 devm_ioport_map() 返回值是否为空。

**示例**
```c
a = devm_ioport_map(...)
if(!a)  //编程规范点：检查 devm_ioport_map() 返回值
   ...
```

**Git 合并地址合并地址**  
a6925165ea82b7765269ddd8dcad57c731aa00de 
</br>
</br>
### <span id = "devm_regmap_init_mmio">R044&emsp;devm_regmap_init_mmio</span>     
<hr/>  

**描述**  
devm_regmap_init_mmio() 用于初始化托管寄存器映射。不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点：使用 IS_ERR() 检查 devm_regmap_init_mmio() 返回值。

**示例**
```c
a = devm_regmap_init_mmio(...)
if (IS_ERR(a))  //编程规范点：检查 devm_regmap_init_mmio() 返回值
   ...
```

**Git 合并地址**  
aa505ecccf2ae7546e0e262d574e18a9241f3005 
</br>
</br>
### <span id = "usbnet_get_endpoints">R045&emsp;usbnet_get_endpoints</span>    
<hr/>  

**描述**  
usbnet_get_endpoints() 用于处理 CDC 以太网及其他网络“批量数据”接口。不当使用会造成未捕获的异常等问题。  

**编程规范**  
规范点：检查 usbnet_get_endpoints() 返回值是否为 0。

**示例**
```c
a = usbnet_get_endpoints(...)
if (a)  //编程规范点：检查 usbnet_get_endpoints() 返回值
   ...
```

**Git 合并地址**  
eaac6a2d26b65511e164772bec6918fcbc61938e 
</br>
</br>
### <span id = "idr_alloc">R046&emsp;idr_alloc</span>    
<hr/>  

**描述**  
idr_alloc() 用于分配 ID 。不当使用会造成未捕获的异常等问题。  

**编程规范**  
规范点：检查 idr_alloc() 返回值是否小于 0。

**示例**
```c
a = idr_alloc(...)
if (a < 0)  //编程规范点：检查 idr_alloc() 返回值
   ...
```

**Git 合并地址**  
6d7860f5750d73da2fa1a1f6c9405058a593fa32 
</br>
</br>
### <span id = "ida_alloc">R047&emsp;ida_alloc</span>     
<hr/>  

**描述**  
ida_alloc() 用于分配未使用的 ID。不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 ida_alloc() 返回值是否小于 0；  
规范点2：该 API 使用后，调用 ida_free() 函数释放分配的 ID。

**示例**
```c
a = ida_alloc(...)
if (a < 0)  //编程规范点1：检查 ida_alloc() 返回值
   ...
...
ida_free(...)    //编程规范点2：使用后释放
```

**Git 合并地址**  
d00f592250782538cda87745607695b0fe27dcd4 
</br>
</br>
### <span id = "rtw_alloc_hwxmits">R048&emsp;rtw_alloc_hwxmits</span>    
<hr/>  

**描述**  
rtw_alloc_hwxmits() 不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点：检查 rtw_alloc_hwxmits() 返回值是否为 _FAIL。

**示例**
```c
a = rtw_alloc_hwxmits(...)
if (a == _FAIL)  //编程规范点：检查 rtw_alloc_hwxmits() 返回值
   ...
```

**Git 合并地址**  
f94b47c6bde624d6c07f43054087607c52054a95  


**CVE**  
CVE-2022-3110
</br>
</br>
### <span id = "mipi_dsi_driver_register">R049&emsp;mipi_dsi_driver_register</span>    
<hr/>  

**描述**  
mipi_dsi_driver_register() 用于注册 DSI 设备的驱动程序。不当使用会造成未捕获的异常等问题。  

**编程规范**  
规范点：检查 mipi_dsi_driver_register() 返回值是否为 0。

**示例**
```c
a = mipi_dsi_driver_register(...)
if (a)  //编程规范点：检查 mipi_dsi_driver_register() 返回值
   ...
```

**Git 合并地址**  
831463667b5f4f1e5bce9c3b94e9e794d2bc8923 
</br>
</br>
### <span id = "nla_put_u32">R050&emsp;nla_put_u32</span>     
<hr/>  

**描述**  
nla_put_u32() 用于将 u32 netlink 属性添加到套接字缓冲区。不当使用会造成未捕获的异常等问题。 

**编程规范**  
规范点：检查 nla_put_u32() 返回值是否为 0。

**示例**
```c
a = nla_put_u32(...)
if (a)  //编程规范点：检查 nla_put_u32() 返回值
   ...
```

**Git 合并地址**  
92a34ab169f9eefe29cd420ce96b0a0a2a1da853 
</br>
</br>
### <span id = "crypto_aead_setkey">R051&emsp;crypto_aead_setkey</span>  
<hr/>  

**描述**  
crypto_aead_setkey() 用于设置密码密钥。不当使用会造成未捕获的异常等问题。  

**编程规范**  
规范点：检查 crypto_aead_setkey() 返回值是否为 0。

**示例**
```c
a = crypto_aead_setkey(...)
if (a)  //编程规范点：检查 crypto_aead_setkey() 返回值
   ...
```

**Git 合并地址**  
ce852f1308ac738e61c5b2502517deea593a1554 
</br>
</br>
### <span id = "alloc_page">R052&emsp;alloc_page</span>     
<hr/>  

**描述**  
alloc_page() 用于分配物理页面。不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 alloc_page() 返回值是否为空；  
规范点2：该 API 使用后，调用 __free_page() 函数释放分配的页面。

**示例**
```c
a = alloc_page(...)
if (!a)  //编程规范点1：检查 alloc_page() 返回值
   ...
...
__free_page(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
5f21d7d283dd82865bdb0123795b3accf0d42b67 
</br>
</br>
### <span id = "device_property_read_u32_array">R053&emsp;device_property_read_u32_array</span>     
<hr/>  

**描述**  
device_property_read_u32_array() 用于返回设备的 U32 数组属性。不当使用会造成未捕获的异常等问题。  

**编程规范**  
规范点：检查 device_property_read_u32_array() 返回值是否为 0。

**示例**
```c
a = device_property_read_u32_array(...)
if (a)  //编程规范点：检查 device_property_read_u32_array() 返回值
   ...
```

**Git 合并地址**  
2167c0b205960607fb136b4bb3c556a62be1569a 
</br>
</br>
### <span id = "of_get_child_by_name">R054&emsp;of_get_child_by_name</span>    
<hr/>  

**描述**  
of_get_child_by_name() 用于按给定父节点的名称查找子节点。不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 of_get_child_by_name() 返回值是否为空；  
规范点2：该 API 使用后，调用 of_node_put() 函数释放。

**示例**
```c
a = of_get_child_by_name(...)
if (!a)  //编程规范点1：检查 of_get_child_by_name() 返回值
   ...
...
of_node_put(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
f7a6021aaf02088870559f82fc13c58cda7fea1a 
</br>
</br>
### <span id = "module_get_next_page">R055&emsp;module_get_next_page</span>     
<hr/>  

**描述**  
module_get_next_page() 不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点：使用 IS_ERR() 检查 module_get_next_page() 返回值。

**示例**
```c
a = module_get_next_page(...)
if(IS_ERR(a))  //编程规范点：检查 module_get_next_page() 返回值
   ...
```

**Git 合并地址**  
45af1d7aae7d5520d2858f8517a1342646f015db    

**CVE**  
CVE-2023-22997 
</br>
</br>
### <span id = "regulator_get">R056&emsp;regulator_get</span>     
<hr/>  

**描述**  
regulator_get() 用于查找并获取对稳定器的引用。不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点：使用 IS_ERR() 检查 regulator_get() 返回值。

**示例**
```c
a = regulator_get(...)
if(IS_ERR(a))  //编程规范点：检查 regulator_get() 返回值
   ...
```

**Git 合并地址**  
3ba880a12df5aa4488c18281701b5b1bc3d4531a    

**CVE**  
CVE-2023-23001 
</br>
</br>
### <span id = "hashmap__new">R057&emsp;hashmap__new</span>     
<hr/>  

**描述**  
hashmap__new() 不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点1：使用 IS_ERR() 检查 hashmap__new() 返回值；  
规范点2：该 API 使用后，调用 hashmap__free() 函数释放。

**示例**
```c
a = hashmap__new(...)
if(IS_ERR(a))  //编程规范点1：检查 hashmap__new() 返回值
   ...
...
hashmap__free(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
0a515a06c5ebfa46fee3ac519e418f801e718da4    

**CVE**  
CVE-2023-23003 
</br>
</br>
### <span id = "get_sg_table">R058&emsp;get_sg_table</span>     
<hr/>  

**描述**  
get_sg_table() 不当使用会造成空指针解引用等漏洞。 

**编程规范**  
规范点：使用 IS_ERR() 检查 get_sg_table() 返回值。

**示例**
```c
a = get_sg_table(...)
if(IS_ERR(a))  //编程规范点：检查 get_sg_table() 返回值
   ...
```

**Git 合并地址**  
15342f930ebebcfe36f2415049736a77d7d2e045    

**CVE**  
CVE-2023-23004 
</br>
</br>
### <span id = "alloc_memory_type">R059&emsp;alloc_memory_type</span>    
<hr/>  

**描述**  
alloc_memory_type() 不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点：使用 IS_ERR() 检查 alloc_memory_type() 返回值。

**示例**
```c
a = alloc_memory_type(...)
if(IS_ERR(a))  //编程规范点：检查 alloc_memory_type() 返回值
   ...
```

**Git 合并地址**  
4a625ceee8a0ab0273534cb6b432ce6b331db5ee    

**CVE**  
CVE-2023-23005 
</br>
</br>
### <span id = "mlx5_get_uars_page">R060&emsp;mlx5_get_uars_page</span>  
<hr/>  

**描述**  
mlx5_get_uars_page() 不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点1：使用 IS_ERR() 检查 mlx5_get_uars_page() 返回值；  
规范点2：该 API 使用后，调用 mlx5_put_uars_page() 函数释放。

**示例**
```c
a = mlx5_get_uars_page(...)
if(IS_ERR(a))  //编程规范点1：检查 mlx5_get_uars_page() 返回值
   ...
...
mlx5_put_uars_page(...)  //编程规范点2：使用后释放
```

**Git 合并地址**  
6b8b42585886c59a008015083282aae434349094    

**CVE**  
CVE-2023-23006 
</br>
</br>
### <span id = "kstrndup">R061&emsp;kstrndup</span>     
<hr/>  

**描述**  
kstrndup() 用于为现有字符串分配空间并复制该字符串。不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 kstrndup() 返回值是否为空；  
规范点2：该 API 使用后释放申请的内存。

**示例**
```c
a = kstrndup(...)
if(!a)  //编程规范点1：检查 kstrndup() 返回值
   ...
...
kfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
fcdf445ff42f036d22178b49cf64e92d527c1330  

**CVE**  
CVE-2019-12455 
</br>
</br>  
### <span id = "kstrdup_const">R062&emsp;kstrdup_const</span>     
<hr/>  

**描述**  
kstrdup_const() 用于有条件地复制现有常量字符串。不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 kstrdup_const() 返回值是否为空；  
规范点2：该 API 使用后释放申请的内存。

**示例**
```c
a = kstrdup_const(...)
if(!a)  //编程规范点1：检查 kstrdup_const() 返回值
   ...
...
kfree_const(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
80caf43549e7e41a695c6d1e11066286538b336f  

**CVE**  
CVE-2019-12615 
</br>
</br>
### <span id = "nfc_llcp_build_tlv">R063&emsp;nfc_llcp_build_tlv</span> 
<hr/>  

**描述**  
nfc_llcp_build_tlv() 不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 nfc_llcp_build_tlv() 返回值是否为空；  
规范点2：该 API 使用后释放申请的内存。

**示例**
```c
a = nfc_llcp_build_tlv(...)
if(!a)  //编程规范点1：检查 nfc_llcp_build_tlv() 返回值
   ...  
...
kfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
58bdd544e2933a21a51eecf17c3f5f94038261b5  

**CVE**  
CVE-2019-12818 
</br>
</br>
### <span id = "alloc_netdev">R064&emsp; alloc_netdev</span>    
<hr/>  

**描述**  
alloc_netdev() 不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 alloc_netdev() 返回值是否为空；  
规范点2：该 API 使用后释放申请的内存。

**示例**
```c
a =  alloc_netdev(...)
if(a)  //编程规范点1：检查 alloc_netdev() 返回值
   ...
...
free_netdev(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
07f12b26e21ab359261bf75cfcb424fdc7daeb6d  

**CVE**  
CVE-2019-16994 
</br>
</br>
### <span id = "netdev_alloc_skb">R065&emsp;netdev_alloc_skb</span>    
<hr/>  

**描述**  
netdev_alloc_skb() 用于在特定设备上为 rx 分配一个 skbuff，不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 netdev_alloc_skb() 返回值是否为空；  
规范点2：该 API 使用后释放申请的内存。

**示例**
```c
a = netdev_alloc_skb(...)
if(a)  //编程规范点1：检查 netdev_alloc_skb() 返回值
   ...
...
dev_kfree_skb(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
1acb8f2a7a9f10543868ddd737e37424d5c36cf4  

**CVE**  
CVE-2019-18806 
</br>
</br>
### <span id = "platform_device_alloc">R066&emsp;platform_device_alloc</span>     
<hr/>  

**描述**  
platform_device_alloc() 用于创建平台设备，不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 platform_device_alloc() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = platform_device_alloc(...)
if(!a)  //编程规范点1：检查 platform_device_alloc() 返回值
   ...
...
platform_device_put(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
9bbfceea12a8f145097a27d7c7267af25893c060  
fa0ef93868a6062babe1144df2807a8b1d4924d2  

**CVE**  
CVE-2019-18813  
CVE-2023-22995
</br>
</br>
### <span id = "kvzalloc">R067&emsp;kvzalloc</span>    
<hr/>  

**描述**  
kvzalloc() 不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 kvzalloc() 返回值是否为空；  
规范点2：该 API 使用后释放。


**示例**
```c
a = kvzalloc(...)
if(!a)  //编程规范点1：检查 kvzalloc() 返回值
   ...
...
kvfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
c8c2a057fdc7de1cd16f4baa51425b932a42eb39  

**CVE**  
CVE-2019-19045 
</br>
</br>
### <span id = "kvmalloc">R068&emsp;kvmalloc</span>    
<hr/>  

**描述**  
kvmalloc() 不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 kvmalloc() 返回值是否为空；  
规范点2：该 API 使用后释放。


**示例**
```c
a = kvmalloc(...)
if(!a)  //编程规范点1：检查 kvmalloc() 返回值
   ...
...
kvfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
c7ed6d0183d5ea9bc31bcaeeba4070bd62546471  

**CVE**  
CVE-2019-19047 
</br>
</br>
### <span id = "nlmsg_new">R069&emsp;nlmsg_new</span>    
<hr/>  

**描述**  
nlmsg_new() 用于分配新的网络链接消息，不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 nlmsg_new() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = nlmsg_new(...)
if(!a)  //编程规范点1：检查 nlmsg_new() 返回值
   ...
...
kfree_skb(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
c03b04dcdba1da39903e23cc4d072abf8f68f2dd  
1399c59fa92984836db90538cf92397fe7caaa57  
ffdde5932042600c6807d46c1550b28b0db6a3bc  

**CVE**  
CVE-2019-19050  
CVE-2019-19055  
CVE-2019-19062</br>
</br>
### <span id = "usb_alloc_urb">R070&emsp;usb_alloc_urb</span>  
<hr/>  

**描述**  
usb_alloc_urb() 用于创建一个新的 urb 供 USB 驱动程序使用，不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 usb_alloc_urb() 返回值是否为空；  
规范点2：该 API 使用后释放。


**示例**
```c
a = usb_alloc_urb(...)
if(!a)  //编程规范点1：检查 usb_alloc_urb() 返回值
   ...
...
usb_free_urb(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
fb5be6a7b4863ecc44963bb80ca614584b6c7817  
a2cdd07488e666aa93a49a3fc9c9b1299e27ef3c  
b8d17e7d93d2beb89e4f34c59996376b8b544792  

**CVE**  
CVE-2019-19052  
CVE-2019-19068  
CVE-2019-19078
</br>
</br>
### <span id = "dev_alloc_skb">R071&emsp;dev_alloc_skb</span>    
<hr/>  

**描述**  
dev_alloc_skb() 不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 dev_alloc_skb() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = dev_alloc_skb(...)
if(!a)  //编程规范点1：检查 dev_alloc_skb() 返回值
   ...
...
dev_kfree_skb(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
db8fd2cde93227e566a412cf53173ffa227998bc  
d10dcb615c8e29d403a24d35f8310a7a53e3050c  
d563131ef23cbc756026f839a82598c8445bc45f

**CVE**  
CVE-2019-19056  
CVE-2019-19057  
CVE-2019-19071 
</br>
</br>
### <span id = "ieee80211_alloc_hw">R072&emsp;ieee80211_alloc_hw</span>  
<hr/>  

**描述**  
ieee80211_alloc_hw() 用于分配新的硬件设备，不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 ieee80211_alloc_hw() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = ieee80211_alloc_hw(...)
if(!a)  //编程规范点1：检查 ieee80211_alloc_hw() 返回值
   ...
...
ieee80211_free_hw(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
3f93616951138a598d930dcaec40f2bfd9ce43bb  

**CVE**  
CVE-2019-19063 
</br>
</br>
### <span id = "spi_alloc_slave">R073&emsp;spi_alloc_slave</span>    
<hr/>  

**描述**  
spi_alloc_slave() 不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 spi_alloc_slave() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = spi_alloc_slave(...)
if(!a)  //编程规范点1：检查 spi_alloc_slave() 返回值
   ...
...
spi_controller_put(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
057b8945f78f76d0b04eeb5c27cd9225e5e7ad86  

**CVE**  
CVE-2019-19064 
</br>
</br>
### <span id = "spi_alloc_master">R074&emsp;spi_alloc_master</span>     
<hr/>  

**描述**  
spi_alloc_master() 不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 spi_alloc_master() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = spi_alloc_master(...)
if(!a)  //编程规范点1：检查 spi_alloc_master() 返回值
   ...
...
spi_controller_put(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
057b8945f78f76d0b04eeb5c27cd9225e5e7ad86  
d3b0ffa1d75d5305ebe34735598993afbb8a869d

**CVE**  
CVE-2019-19064  
CVE-2019-19070 
</br>
</br>
### <span id = "alloc_skb">R075&emsp;alloc_skb</span>    
<hr/>  

**描述**  
alloc_skb() 用于分配网络缓冲区，不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 alloc_skb() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = alloc_skb(...)
if(!a)  //编程规范点1：检查 alloc_skb() 返回值
   ...
...
kfree_skb(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
853acf7caf10b828102d92d05b5c101666a6142b  
728c1e2a05e4b5fc52fab3421dce772a806612a2  

**CVE**  
CVE-2019-19073  
CVE-2019-19074
</br>
</br>
### <span id = "ib_umem_get">R076&emsp;ib_umem_get</span>     
<hr/>  

**描述**  
ib_umem_get() 不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 ib_umem_get() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = ib_umem_get(...)
if(IS_ERR(a))  //编程规范点1：检查 ib_umem_get() 返回值
   ...
...
ib_umem_release(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
4a9d46a9fe14401f21df69cea97c62396d5fb053  

**CVE**  
CVE-2019-19077 
</br>
</br>  
### <span id = "nfp_repr_alloc">R077&emsp;nfp_repr_alloc</span>     
<hr/>  

**描述**  
nfp_repr_alloc() 不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 nfp_repr_alloc() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = nfp_repr_alloc(...)
if(!a)  //编程规范点1：检查 nfp_repr_alloc() 返回值
   ...
...
nfp_repr_free(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
8572cea1461a006bce1d06c0c4b0575869125fa4  
8ce39eb5a67aee25d9f05b40b673c95b23502e3e  

**CVE**  
CVE-2019-19080  
CVE-2019-19081 
</br>
</br>
### <span id = "snd_card_new">R078&emsp;snd_card_new</span>     
<hr/>  

**描述**  
snd_card_new() 用于创建和初始化声卡结构，不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 snd_card_new() 返回值是否小于 0；  
规范点2：该 API 使用后释放。

**示例**
```c
a = snd_card_new(...)
if(a < 0)  //编程规范点1：检查 snd_card_new() 返回值
   ...
...
snd_card_free(...)  //编程规范点2：使用后释放
```

**Git 合并地址**  
9453264ef58638ce8976121ac44c07a3ef375983  

**CVE**  
CVE-2019-20810 
</br>
</br>
### <span id = "vmalloc">R079&emsp;vmalloc</span>     
<hr/>  

**描述**  
vmalloc() 用于分配在虚拟连续内存，不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 vmalloc() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = vmalloc(...)
if(!a)  //编程规范点1：检查 vmalloc() 返回值
   ...
...
vfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
f612acfae86af7ecad754ae6a46019be9da05b8e  

**CVE**  
CVE-2019-8980 
</br>
</br>
### <span id = "fsnotify_find_mark">R080&emsp;fsnotify_find_mark</span> 
<hr/>  

**描述**  
fsnotify_find_mark() 用于给定标记列表，找到与给定组关联的标记，不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 fsnotify_find_mark() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = fsnotify_find_mark(...)
if(!a)  //编程规范点1：检查 fsnotify_find_mark() 返回值
   ...
...
fsnotify_put_mark(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
62c9d2674b31d4c8a674bee86b7edc6da2803aea  

**CVE**  
CVE-2019-9857 
</br>
</br>
### <span id = "alloc_smp_req">R081&emsp;alloc_smp_req</span>     
<hr/>  

**描述**  
alloc_smp_req() 不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 alloc_smp_req() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = alloc_smp_req(...)
if(!a)  //编程规范点1：检查 alloc_smp_req() 返回值
   ...
...
kfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
4a491b1ab11ca0556d2fda1ff1301e862a2d44c4  

**CVE**  
CVE-2018-7757 
</br>
</br>  
### <span id = "ring_buffer_alloc">R082&emsp;ring_buffer_alloc</span>    
<hr/>  

**描述**  
ring_buffer_alloc() 不当使用会造成双重释放等漏洞。  

**编程规范**  
规范点1：检查 ring_buffer_alloc() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = ring_buffer_alloc(...)
if(!a)  //编程规范点1：检查 ring_buffer_alloc() 返回值
   ...
...
ring_buffer_free(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
4397f04575c44e1440ec2e49b6302785c95fd2f8  

**CVE**  
CVE-2017-18595 
</br>
</br>
### <span id = "of_find_device_by_node">R083&emsp;of_find_device_by_node</span>     
<hr/>  

**描述**  
of_find_device_by_node() 用于查找与节点关联的 platform_device，不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 of_find_device_by_node() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = of_find_device_by_node(...)
if(!a)  //编程规范点1：检查 of_find_device_by_node() 返回值
   ...
...
put_device(...)  //编程规范点2：使用后释放
```

**Git 合并地址**  
4b41a9d0fe3db5f91078a380f62f0572c3ecf2dd  

**CVE**  
CVE-2023-22996 
</br>
</br>
### <span id = "drm_gem_shmem_get_sg_table">R084&emsp;drm_gem_shmem_get_sg_table</span>  
<hr/>  

**描述**  
drm_gem_shmem_get_sg_table() 用于为 shmem GEM 对象提供固定页面的分散/聚集表，不当使用会空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 drm_gem_shmem_get_sg_table() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = drm_gem_shmem_get_sg_table(...)
if(IS_ERR(a))  //编程规范点1：检查 drm_gem_shmem_get_sg_table() 返回值
   ...
...
sg_free_table(a)  //编程规范点2：使用后释放
kfree(a)
```

**Git 合并地址**  
c24968734abfed81c8f93dc5f44a7b7a9aecadfa  

**CVE**  
CVE-2023-22998 
</br>
</br>
### <span id = "dwc3_qcom_create_urs_usb_platdev">R085&emsp;dwc3_qcom_create_urs_usb_platdev</span>     
<hr/>  

**描述**  
dwc3_qcom_create_urs_usb_platdev() 不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 dwc3_qcom_create_urs_usb_platdev() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = dwc3_qcom_create_urs_usb_platdev(...)
if(IS_ERR_OR_NULL(a))  //编程规范点1：检查 dwc3_qcom_create_urs_usb_platdev() 返回值
   ...
...
dwc3_qcom_destroy_urs_usb_platdev(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
b52fe2dbb3e655eb1483000adfab68a219549e13  

**CVE**  
CVE-2023-22999 
</br>
</br>
### <span id = "devm_gpiod_get_optional">R086&emsp;devm_gpiod_get_optional</span>     
<hr/>  

**描述**  
devm_gpiod_get_optional() 不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点：检查 devm_gpiod_get_optional() 返回值是否为空。

**示例**
```c
a = devm_gpiod_get_optional(...)
if(IS_ERR_OR_NULL(a))  //编程规范点：检查 devm_gpiod_get_optional() 返回值
   ...
```

**Git 合并地址**  
6845667146a28c09b5dfc401c1ad112374087944  

**CVE**  
CVE-2023-23002 
</br>
</br>
### <span id = "xa_alloc_cyclic">R087&emsp;xa_alloc_cyclic</span>     
<hr/>  

**描述**  
xa_alloc_cyclic() 用于在 XArray 中查找存储此条目的位置，不当使用会造成释放后重用等漏洞。  

**编程规范**   
规范点1：检查 xa_alloc_cyclic() 返回值是否小于 0；  
规范点2：该 API 使用后释放。

**示例**
```c
a = xa_alloc_cyclic(...)
if(a < 0)  //编程规范点1：检查 xa_alloc_cyclic() 返回值
   ...
...
xa_erase(...)  //编程规范点2：使用后释放
```

**Git 合并地址**  
a30f895ad3239f45012e860d4f94c1a388b36d14  

**CVE**  
CVE-2022-1043 
</br>
</br>
### <span id = "memdup_user">R088&emsp;memdup_user</span>     
<hr/>  

**描述**  
memdup_user() 用于从用户空间复制内存区域，不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 memdup_user() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = memdup_user(...)
if(IS_ERR(a))  //编程规范点1：检查 memdup_user() 返回值
   ...
...
kfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
ecd1735f14d6ac868ae5d8b7a2bf193fa11f388b 

**CVE**  
CVE-2022-1651 
</br>
</br>
### <span id = "virtqueue_get_buf">R089&emsp;virtqueue_get_buf</span>    
<hr/>  

**描述**  
virtqueue_get_buf() 不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 virtqueue_get_buf() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = virtqueue_get_buf(...)
if(!a)  //编程规范点1：检查 virtqueue_get_buf() 返回值
   ...
...
kfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
1d0688421449718c6c5f46e458a378c9b530ba18  

**CVE**  
CVE-2022-26878 
</br>
</br>
### <span id = "crypto_alloc_aead">R090&emsp;crypto_alloc_aead</span>    
<hr/>  

**描述**  
crypto_alloc_aead() 分配 AEAD 密码句柄。不当使用会造成空指针解引用等漏洞。  

**编程规范**  
规范点1：检查 crypto_alloc_aead() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = crypto_alloc_aead(...)
if(IS_ERR(a))  //编程规范点1：检查 crypto_alloc_aead() 返回值
   ...   
...
crypto_free_aead(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
1165affd484889d4986cf3b724318935a0b120d8  

**CVE**  
CVE-2021-3659 
</br>
</br>  
### <span id = "match_strdup">R091&emsp;match_strdup</span>     
<hr/>  

**描述**  
match_strdup() 用于使用 substring_t 的内容分配一个新字符串，不当使用会造成内存泄漏等漏洞。  

**编程规范**  
规范点1：检查 match_strdup() 返回值是否为空；  
规范点2：该 API 使用后释放。

**示例**
```c
a = match_strdup(...)
if(!a)  //编程规范点1：检查 match_strdup() 返回值
   ...
...
kfree(a)  //编程规范点2：使用后释放
```

**Git 合并地址**  
7bdb157cdebbf95a1cd94ed2e01b338714075d00  

**CVE**  
CVE-2020-25704 
</br>
</br>

作者信息：中国科学院软件研究所